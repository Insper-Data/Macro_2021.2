setwd("~/Insper/Data/Projeto Macro/Data_Macro_ESG/Macro_2021.2")
rm(list=ls())
library(tidyverse)
library(gganimate)
library(ggplot2)
library(dplyr)
library(gapminder)
library(ggthemes)
library(gifski)
library(readr)
library(tidyr)
library(readxl)
library(plm)
# Combinando as bases de dados
ESG_PCA_indexes <- read.csv("Bases/ESG_PCA_indexes.csv")
spreads <- read_excel("Bases/yield_bonds.xlsx")
spreads$X <- paste(spreads$...1, "-", spreads$Ano)
spreads <- spreads[order(spreads$X),]
ESG_PCA_indexes$spreads <- spreads$`United States`
panel_past <- pdata.frame(read.csv("Bases/Datasets/dataset_total.csv"), c("country", "year"))
panel_past$X <- rownames(panel_past)
rownames(ESG_PCA_indexes) <- ESG_PCA_indexes$X
data <- left_join(ESG_PCA_indexes, panel_past, by = c("X" = "X"))
write.csv(data, "Bases/merged.csv")
